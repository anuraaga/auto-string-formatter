apply plugin: "me.champeau.gradle.jmh"

archivesBaseName = 'string-formatter-example'

dependencies {
    apt project(':processor')
    compile project(':runtime')
    compile 'javax.inject:javax.inject:1'

    testApt project(':processor')
    testCompile project(':runtime')

    testApt "org.openjdk.jmh:jmh-generator-annprocess:${jmh.jmhVersion}"
    testCompile "org.openjdk.jmh:jmh-core:${jmh.jmhVersion}"
}

jmh {
    zip64 = true
    jmhVersion = '1.10.+'
    timeUnit = 'ms'
    fork = 2
    iterations = 10
    warmupIterations = 10
    include = '.*Bench'
}

test {
    exclude '**/*Bench.*'
}

task benchmark(type: Test) {
    reports.html.destination = file("$buildDir/reports/benchmarks")
    filter {
        includeTestsMatching '*Bench'
        failOnNoMatchingTests false
    }
}
